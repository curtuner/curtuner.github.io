{"md5":"00081a0b74038613e19e1d199e255530","content":"\n\n\n<div id=\"outline-container-orgc214d19\" class=\"outline-2\">\n<h2 id=\"orgc214d19\"><span class=\"section-number-2\">1</span> vlan</h2>\n<div class=\"outline-text-2\" id=\"text-1\">\n<p>\nvlan 二层交换机\n</p>\n\n<ul class=\"org-ul\">\n<li>首先access端口是指拥有一个和PVID标记相同的VID的物理端口，所以对于VID</li>\n<li>pvid决定了处理tag的过程，vlan则决定了taged和untaged的属性，一个trunk端口可以属于多个vlan,端口的vlan</li>\n<li>是否允许打tag的数据包通过，以区分tag和untag, trunk值允许打tag</li>\n<li>vlan 是要阻止过度泛洪的方法，内部只有含共同的vlan的的端口才可以使用</li>\n</ul>\n</div>\n<div id=\"outline-container-orgb444b00\" class=\"outline-3\">\n<h3 id=\"orgb444b00\"><span class=\"section-number-3\">1.1</span> 使用ssdk<sub>sh来配置端口vlan</sub></h3>\n<div class=\"outline-text-3\" id=\"text-1-1\">\n<p>\nssdk<sub>sh的设置其实是switch芯片</sub>，CPU本身都内置一个switch芯片，但内置的不能满足要求，所以有一个独立的switch芯片，通过SGMII是PHY与MAC间。ssdk<sub>sh提供了一种上层配置方式</sub>。\n先增加一个vlan, vlan id 设为2\n</p>\n<div class=\"org-src-container\">\n<figure class=\"highlight sh\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssdk_sh vlan entry create <span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>\n接下来设定端口号的vlan，或者说在vlan中加入端口（ssdk<sub>sh更倾向这种想法</sub>），这里将端口2的vlanid设为2，并设为untaged（还可以有unmodified|tagged）\n</p>\n<div class=\"org-src-container\">\n<figure class=\"highlight sh\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssdk_sh vlan member add <span class=\"number\">2</span> <span class=\"number\">2</span> untaged</span><br></pre></td></tr></table></figure>\n</div>\n</div>\n</div>\n</div>\n\n<div id=\"outline-container-orgf6fae63\" class=\"outline-2\">\n<h2 id=\"orgf6fae63\"><span class=\"section-number-2\">2</span> 网络接口（包括物理的和虚拟的）</h2>\n<div class=\"outline-text-2\" id=\"text-2\">\n</div><div id=\"outline-container-org281b594\" class=\"outline-3\">\n<h3 id=\"org281b594\"><span class=\"section-number-3\">2.1</span> 物理网卡（网络配置器，Network Interface Card）</h3>\n<div class=\"outline-text-3\" id=\"text-2-1\">\n<p>\n网卡由MAC芯片、PHY芯片和接口组成。MAC芯片实现MAC子层和LLC子层，提供符合规范的接口以实现 <b>和主机的数据交换</b> ，\n</p>\n</div>\n</div>\n<div id=\"outline-container-org38c609b\" class=\"outline-3\">\n<h3 id=\"org38c609b\"><span class=\"section-number-3\">2.2</span> 虚拟网卡</h3>\n<div class=\"outline-text-3\" id=\"text-2-2\">\n<p>\n要查看但前计算机的网络设备可以直接使用ifconfig或者ip link来查看。其中虚拟网络接口是为了便于管理员配置基于linux的操作系统。一个虚拟网络接口一般与一个物理接口或其他虚拟网络接口相关。网卡设置为监听模式之后无法联网的问题，可以使用在该网卡上增加一个虚拟接口来实现。\n</p>\n<ul class=\"org-ul\">\n<li>lo: 虚拟设备，回环网设备接口</li>\n<li>br-lan: lan网桥</li>\n</ul>\n</div>\n</div>\n</div>\n<div id=\"outline-container-orgbcdeb0e\" class=\"outline-2\">\n<h2 id=\"orgbcdeb0e\"><span class=\"section-number-2\">3</span> 配置</h2>\n<div class=\"outline-text-2\" id=\"text-3\">\n</div><div id=\"outline-container-orgc0abb40\" class=\"outline-3\">\n<h3 id=\"orgc0abb40\"><span class=\"section-number-3\">3.1</span> 网络配置文件</h3>\n<div class=\"outline-text-3\" id=\"text-3-1\">\n<blockquote>\n<p>\n/etc/config/network：该文件是网络配置文件，该文件包含了WAN、LAN、LOOPBACK(本机自身回环网),VLAN(虚拟局域网)的全部配置。即负责交换、接口和路由配置。\n/etc/config/wireless：无线网络的配置文件，该文件包含了无线网络的协议，参数，速率等信息。\n</p>\n</blockquote>\n<p>\n其中，'loopback'表示本机自环网配置段，'lan'表示LAN口配置，'wan'表示WAN口配置，switch表示VLAN配置(虚拟局域网)，switch<sub>vlan表示VLAN1的参数</sub>。另外属于一般的端口属于物理端口。这里是swconfig是的switch vlan的配置风格。\n</p>\n</div>\n</div>\n<div id=\"outline-container-org24f2435\" class=\"outline-3\">\n<h3 id=\"org24f2435\"><span class=\"section-number-3\">3.2</span> 使用网络配置文件来配置vlan</h3>\n<div class=\"outline-text-3\" id=\"text-3-2\">\n<p>\n首先，了解设备有几个可独立配置vlan口。使用swconfig风格的配置：\n</p>\n<div class=\"org-src-container\">\n<figure class=\"highlight sh\"><table><tr><td class=\"code\"><pre><span class=\"line\">config <span class=\"string\">'switch'</span></span><br><span class=\"line\">     option <span class=\"string\">'name'</span> <span class=\"string\">'rtl8366s'</span></span><br><span class=\"line\">     option <span class=\"string\">'reset'</span> <span class=\"string\">'1'</span></span><br><span class=\"line\">     option <span class=\"string\">'enable_vlan'</span> <span class=\"string\">'1'</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>\n打开芯片的vlan功能，可以看到config 'switch'节是设置vlan功能的启动与否。switch\n</p>\n</div>\n</div>\n</div>\n<div id=\"outline-container-org756ef2d\" class=\"outline-2\">\n<h2 id=\"org756ef2d\"><span class=\"section-number-2\">4</span> FAQ</h2>\n<div class=\"outline-text-2\" id=\"text-4\">\n</div><div id=\"outline-container-org6659f96\" class=\"outline-3\">\n<h3 id=\"org6659f96\"><span class=\"section-number-3\">4.1</span> <span class=\"todo TODO\">TODO</span> openwrt设备接口中WAN、LAN接口的区别？</h3>\n<div class=\"outline-text-3\" id=\"text-4-1\">\n<p>\n首先Internet是WAN的一种，是最大的Internet。所以WAN口一般是连接Internet的接口。LAN口则是连接局域网的设备。除此之外WiFi口则是类似于LAN口\n</p>\n</div>\n</div>\n<div id=\"outline-container-orgf2237e3\" class=\"outline-3\">\n<h3 id=\"orgf2237e3\"><span class=\"section-number-3\">4.2</span> Port-Based Vlan和IEEE 802.1Q Vlan 的区别？</h3>\n<div class=\"outline-text-3\" id=\"text-4-2\">\n<p>\nport base不打标签为\n</p>\n</div>\n</div>\n</div>\n\nLast Updated 2017-04-22 六 01:12.<br>Render by <a href=\"https://github.com/CodeFalling/hexo-renderer-org\">hexo-renderer-org</a> with <a href=\"http://www.gnu.org/software/emacs/\">Emacs</a> 25.2.1 (<a href=\"http://orgmode.org\">Org</a> mode 9.0.5)\n"}
