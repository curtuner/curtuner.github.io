#+TITLE: 动态链接
#+DATE: 2017-06-28
#+LAYOUT: post
#+TAGS: Linux
#+CATEGORIES: Linux

* 前言
  静态链接的缺点是空间利用存在太多的浪费，所以人们将链接的过程推迟到了运行时。接口兼容是共享库的一大问题。缺少共享库的版本管理的话，就容易出现Windows下的DLL Hell。ELF文件中就有动态共享对象（Dynamic Shared Objects）。一般动态链接库也被当作程序的主要模块。最常用的一些模块或者库一般都是动态链接的。程序如果使用了动态链接库，那么在加载时动态链接器会将动态库load到进程空间中。动态库和静态库相比会有一定的性能损失。
* 要点
  - 共享对象的加载地址是在运行时有动态链接器根据地址空闲情况确定的
  - 在32位Linux系统中，动态链接库的映射区一般是从1GB开始的
* -fpic和fPIC
  -fpic存在平台上的限制
* Linux 共享库的组织
  共享库的使用太多了

** 共享库的版本命名
   共享对象命名一般是这种形式：
   libname.so.x.y.z
   其中x一般是在进行了不兼容的重大升级之后会改动的。y一般是在增加了新的接口符号后才改动的，保持了向后兼容。z则是在进行了一些错误修正和性能改进后才改动的，完全保持向后兼容。
